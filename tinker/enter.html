<html>
<head>
<script>
var email;
var store = window.localStorage;

function my_alert ( email )
{
    alert ( email + " is not a valid email address" );
}
function my_function ( event )
{
    if ( event.code == 'Enter' )
    {
	email = document.getElementById("email").value.trim();
	if ( /^\S+@\S+\.\S+$/.test(email) )
	{
	    var count = store.getItem ( email );
	    if ( count == null ) count = 0;
	    else count = parseInt ( count );
	    count += 1;
	    store.setItem ( email, count );
	    document.getElementById("copy").innerHTML =
	        email + " " + count;
	}
	else if ( email != '' )
	    Promise.resolve(email).then(my_alert);
	    // This schedules a separate task so the
	    // time the user takes to OK the alert
	    // is not part of the keypress task,
	    // which would be a violation of the
	    // rules.
    }
}
    
</script>
</head>

<body>

<input onkeypress='my_function(event)' type='email' id='email' placeholder='Email Address'>
<br><br>
<p>Copy&nbsp;<span id="copy"></span></p>
<br><br>
<button onclick="store.clear()">Clear Store</button>


</body>
</html>
